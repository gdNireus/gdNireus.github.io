<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>Docker部署mysql，并配置远程连接 | 小白的博客</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Just playing around">
    <link rel="preload" href="/assets/css/0.styles.0fb95d8c.css" as="style"><link rel="preload" href="/assets/js/app.f9ea9351.js" as="script"><link rel="preload" href="/assets/js/2.319cdf4d.js" as="script"><link rel="preload" href="/assets/js/7.29b4374d.js" as="script"><link rel="prefetch" href="/assets/js/10.e91ed8c9.js"><link rel="prefetch" href="/assets/js/11.4ee2e258.js"><link rel="prefetch" href="/assets/js/12.1c70850d.js"><link rel="prefetch" href="/assets/js/3.8f8e6d03.js"><link rel="prefetch" href="/assets/js/4.a00a2e04.js"><link rel="prefetch" href="/assets/js/5.4a3f58e0.js"><link rel="prefetch" href="/assets/js/6.9a037378.js"><link rel="prefetch" href="/assets/js/8.2905332a.js"><link rel="prefetch" href="/assets/js/9.91be638b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0fb95d8c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="ant-row"><div class="sidebar-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/" class="router-link-active no-logo home-link"><!----> <span class="site-name">小白的博客</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div> <!----></header> <aside class="sidebar"><!----> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Docker部署mysql，并配置远程连接</span> <!----></p> <!----></section></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h1 id="docker部署mysql-并配置远程连接"><a href="#docker部署mysql-并配置远程连接" class="header-anchor">#</a> Docker部署mysql，并配置远程连接</h1> <h1 id="获取mysql镜像"><a href="#获取mysql镜像" class="header-anchor">#</a> 获取mysql镜像</h1> <p>​    经典版本，用mysql5.7</p> <div class="language-sh extra-class"><pre class="language-sh"><code>docker pull mysql
</code></pre></div><h1 id="启动容器"><a href="#启动容器" class="header-anchor">#</a> 启动容器</h1> <p>在启动容器之前，我先创建一个数据卷来进行持久化，当然也可以直接-v进行指定，我这里就将数据卷交给docker进行管理：</p> <div class="language-undefined extra-class"><pre class="language-text"><code>docker volume create mysql
</code></pre></div><p>​    查看创建的volume：</p> <div class="language-undefined extra-class"><pre class="language-text"><code>docker volume ls
</code></pre></div><p>​    显示：</p> <blockquote><p>local               2f525b14bfa7cbe0da1bb941cdb5a92c4dfdae07d08d09429ffe50ace1232ece
local               9bb95640dd22ffb2df3a102ec05409580480b7a5bab5f25dde7296e25681da4e
local               mysql</p></blockquote> <p>​    说明创建成功了，接下来启动容器：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code>docker container run <span class="token operator">-</span>p <span class="token number">3306</span><span class="token operator">:</span><span class="token number">3306</span> <span class="token operator">--</span>mount source<span class="token operator">=</span>mysql<span class="token punctuation">,</span>destination<span class="token operator">=</span><span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lib<span class="token operator">/</span>mysql <span class="token operator">-</span>v <span class="token operator">/</span>etc<span class="token operator">/</span>localtime<span class="token operator">:</span><span class="token operator">/</span>etc<span class="token operator">/</span>localtime <span class="token operator">-</span>e <span class="token constant">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span>password <span class="token operator">--</span>name mysql <span class="token operator">-</span>d mysql<span class="token operator">:</span><span class="token number">5.7</span>
</code></pre></div><p>简要说明：</p> <ol><li><code>docker container run</code>：启动一个容器并运行。以前版本直接用docker run，后来我估计是为了更细分职责，docker添加了manager command，即docker container，docker image等等。这样符合了模块化的思想，职责更明确（个人想法，有错请各位大佬更正）。</li> <li>​     <code>-p 3306:3306</code>：宿主机的3306端口与容器的3306端口进行绑定。这样外部可以通过访问宿主机的3306端口进而访问到容器中的3306端口。</li> <li>​     <code>--mount source=mysql,destination=/var/lib/mysql</code>：数据卷进行绑定。source是指的上面我们在宿主机创建出来的volume，destination即我们要与容器中的哪个数据卷进行绑定。当然绑定数据卷还可以用<code>-v 宿主机数据卷:容器数据卷</code>进行绑定。</li> <li>​     <code>-v /etc/localtime:/etc/localtime</code>：设定容器的时间与宿主机保持一致。</li> <li>​     <code>-e MYSQL_ROOT_PASSWORD=password</code>：设置容器的环境变量。相当于在容器中<code>export MYSQL_ROOT_PASSWORD=password</code>的作用。</li> <li>​    <code>--name mysql</code>：设置容器的名称mysql。注意：容器名称是唯一的。</li> <li>​     <code>-d</code>：告诉容器在后台运行。</li> <li>​     <code>mysql:5.7</code>：告诉容器运行的镜像名为mysql。</li></ol> <h1 id="设置远程访问"><a href="#设置远程访问" class="header-anchor">#</a> 设置远程访问</h1> <p>刚起的mysql容器不具备远程连接的功能，需要我们进入容器中进行设置，首先我们先进入启动的mysql容器：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker container <span class="token builtin class-name">exec</span> -it mysql <span class="token function">bash</span>
</code></pre></div><p>​    这时你会进入容器的终端界面，启动mysql的连接命令即可：</p> <div class="language-undefined extra-class"><pre class="language-text"><code>mysql -uroot -p
</code></pre></div><p>这里的<code>-p</code>的值就是上面你创建容器时设置的环境变量<code>MYSQL_ROOT_PASSWORD</code>的值。</p> <p>选中mysql数据库：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>use mysql<span class="token punctuation">;</span>
</code></pre></div><p>执行授权语句</p> <div class="language-shell extra-class"><pre class="language-shell"><code>grant all privileges on *.*  to <span class="token string">'root'</span>@<span class="token string">'%'</span><span class="token punctuation">;</span>
</code></pre></div><p>刷新缓存</p> <div class="language-shell extra-class"><pre class="language-shell"><code>flush privileges<span class="token punctuation">;</span>
</code></pre></div><p>成功的输出如下：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>mysql<span class="token operator">&gt;</span> use mysql
Reading table information <span class="token keyword">for</span> completion of table and <span class="token function">column</span> names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql<span class="token operator">&gt;</span> grant all privileges on *.*  to <span class="token string">'root'</span>@<span class="token string">'%'</span><span class="token punctuation">;</span>
Query OK, <span class="token number">0</span> rows affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> flush privileges<span class="token punctuation">;</span>
Query OK, <span class="token number">0</span> rows affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

</code></pre></div><Valine></Valine></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.f9ea9351.js" defer></script><script src="/assets/js/2.319cdf4d.js" defer></script><script src="/assets/js/7.29b4374d.js" defer></script>
  </body>
</html>