(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{746:function(s,a,t){"use strict";t.r(a);var e=t(68),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"docker部署mysql-并配置远程连接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker部署mysql-并配置远程连接"}},[s._v("#")]),s._v(" Docker部署mysql，并配置远程连接")]),s._v(" "),t("h1",{attrs:{id:"获取mysql镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获取mysql镜像"}},[s._v("#")]),s._v(" 获取mysql镜像")]),s._v(" "),t("p",[s._v("​    经典版本，用mysql5.7")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker pull mysql\n")])])]),t("h1",{attrs:{id:"启动容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动容器"}},[s._v("#")]),s._v(" 启动容器")]),s._v(" "),t("p",[s._v("在启动容器之前，我先创建一个数据卷来进行持久化，当然也可以直接-v进行指定，我这里就将数据卷交给docker进行管理：")]),s._v(" "),t("div",{staticClass:"language-undefined extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("docker volume create mysql\n")])])]),t("p",[s._v("​    查看创建的volume：")]),s._v(" "),t("div",{staticClass:"language-undefined extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("docker volume ls\n")])])]),t("p",[s._v("​    显示：")]),s._v(" "),t("blockquote",[t("p",[s._v("local               2f525b14bfa7cbe0da1bb941cdb5a92c4dfdae07d08d09429ffe50ace1232ece\nlocal               9bb95640dd22ffb2df3a102ec05409580480b7a5bab5f25dde7296e25681da4e\nlocal               mysql")])]),s._v(" "),t("p",[s._v("​    说明创建成功了，接下来启动容器：")]),s._v(" "),t("div",{staticClass:"language-jsx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-jsx"}},[t("code",[s._v("docker container run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("mount source"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("destination"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("localtime"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("localtime "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("e "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MYSQL_ROOT_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("password "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name mysql "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),s._v("\n")])])]),t("p",[s._v("简要说明：")]),s._v(" "),t("ol",[t("li",[t("code",[s._v("docker container run")]),s._v("：启动一个容器并运行。以前版本直接用docker run，后来我估计是为了更细分职责，docker添加了manager command，即docker container，docker image等等。这样符合了模块化的思想，职责更明确（个人想法，有错请各位大佬更正）。")]),s._v(" "),t("li",[s._v("​     "),t("code",[s._v("-p 3306:3306")]),s._v("：宿主机的3306端口与容器的3306端口进行绑定。这样外部可以通过访问宿主机的3306端口进而访问到容器中的3306端口。")]),s._v(" "),t("li",[s._v("​     "),t("code",[s._v("--mount source=mysql,destination=/var/lib/mysql")]),s._v("：数据卷进行绑定。source是指的上面我们在宿主机创建出来的volume，destination即我们要与容器中的哪个数据卷进行绑定。当然绑定数据卷还可以用"),t("code",[s._v("-v 宿主机数据卷:容器数据卷")]),s._v("进行绑定。")]),s._v(" "),t("li",[s._v("​     "),t("code",[s._v("-v /etc/localtime:/etc/localtime")]),s._v("：设定容器的时间与宿主机保持一致。")]),s._v(" "),t("li",[s._v("​     "),t("code",[s._v("-e MYSQL_ROOT_PASSWORD=password")]),s._v("：设置容器的环境变量。相当于在容器中"),t("code",[s._v("export MYSQL_ROOT_PASSWORD=password")]),s._v("的作用。")]),s._v(" "),t("li",[s._v("​    "),t("code",[s._v("--name mysql")]),s._v("：设置容器的名称mysql。注意：容器名称是唯一的。")]),s._v(" "),t("li",[s._v("​     "),t("code",[s._v("-d")]),s._v("：告诉容器在后台运行。")]),s._v(" "),t("li",[s._v("​     "),t("code",[s._v("mysql:5.7")]),s._v("：告诉容器运行的镜像名为mysql。")])]),s._v(" "),t("h1",{attrs:{id:"设置远程访问"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置远程访问"}},[s._v("#")]),s._v(" 设置远程访问")]),s._v(" "),t("p",[s._v("刚起的mysql容器不具备远程连接的功能，需要我们进入容器中进行设置，首先我们先进入启动的mysql容器：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker container "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it mysql "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\n")])])]),t("p",[s._v("​    这时你会进入容器的终端界面，启动mysql的连接命令即可：")]),s._v(" "),t("div",{staticClass:"language-undefined extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("mysql -uroot -p\n")])])]),t("p",[s._v("这里的"),t("code",[s._v("-p")]),s._v("的值就是上面你创建容器时设置的环境变量"),t("code",[s._v("MYSQL_ROOT_PASSWORD")]),s._v("的值。")]),s._v(" "),t("p",[s._v("选中mysql数据库：")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("use mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("执行授权语句")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("grant all privileges on *.*  to "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("刷新缓存")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("flush privileges"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("成功的输出如下：")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" use mysql\nReading table information "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" completion of table and "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("column")]),s._v(" names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" grant all privileges on *.*  to "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nQuery OK, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" rows affected "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sec"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" flush privileges"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nQuery OK, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" rows affected "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sec"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n")])])]),t("Valine")],1)}),[],!1,null,null,null);a.default=r.exports}}]);